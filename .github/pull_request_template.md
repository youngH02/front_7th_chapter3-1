# Chapter3-1. UI 컴포넌트 모듈화와 디자인 시스템

## 과제 목표

**레거시 코드베이스를 현대적인 디자인 시스템으로 개편하는 실무 경험**

1. 정리되지 않은 레거시 코드의 문제점 식별 및 분석
2. TailwindCSS, shadcn/ui, CVA 등의 현대 도구 활용
3. 일관된 디자인 토큰과 컴포넌트 API 구축
4. UI와 비즈니스 로직이 적절한 분리된 리팩토링

---

## Before 패키지 분석 후 After 패키지 개편

### 개편 목표

**디자인 시스템**
- TailwindCSS 기반 일관된 디자인 토큰 정의
- 하드코딩 제거, 재사용 가능한 스타일 시스템 구축
- dark mode, 반응형 등 확장 가능한 구조

**컴포넌트 아키텍처**
- UI 컴포넌트는 순수하게 UI만 담당
- 도메인 로직은 적절히 분리
- 일관된 컴포넌트 API 설계

### 사용할 도구

**TailwindCSS 4.x**
- 디자인 토큰 기반 스타일링
- 유틸리티 클래스 활용
- dark mode, 반응형 내장 지원

**shadcn/ui**
- Radix UI 기반, 접근성 내장
- 복사 가능한 컴포넌트 (라이브러리가 아닌 소스코드)
- 자유로운 커스터마이징

**CVA (Class Variance Authority)**
- 선언적 variants 패턴
- 타입 안전한 스타일 조합
- 조건부 스타일링 처리

**React Hook Form + Zod**
- 선언적 폼 검증
- 타입 안전한 스키마
- 최소 리렌더링 최적화

---

## 필수 과제

### 1. 디자인 시스템 구축
- [x] TailwindCSS 설정 및 디자인 토큰 정의
- [x] shadcn/ui 컴포넌트 설치 (Button, Input, Select, Card, Table 등)
- [x] CVA를 활용한 variants 패턴 적용
- [x] 일관된 스타일 시스템 구축

### 2. Before 패키지 분석
- [x] Before 패키지 실행 및 전체 코드 탐색
- [x] 스타일링, 컴포넌트 설계, 폼 관리 측면에서 문제점 파악
- [x] 개선이 필요한 부분과 그 이유 정리

### 3. 컴포넌트 개편
- [x] UI와 비즈니스 로직 분리
- [x] 순수한 UI 컴포넌트로 재구성
- [x] 일관된 컴포넌트 API 설계
- [x] 적절한 컴포넌트 구조 설계

---

## 심화 과제

- [x] Dark Mode 완전 지원 (CSS Variables + Tailwind)
- [x] Design Token 시스템 고도화 (색상 팔레트, 타이포그래피 스케일)
- [x] 뷰와 비즈니스로직이 분리되도록 

---

## 과제 회고

이번 과제를 진행하면서 가장 중요하게 느낀 것은 처음 구조를 잡는 것의 중요성이었습니다. 컴포넌트를 어디까지 나눠야 할지, 폴더 구조를 어떻게 가져갈지 계속 고민되어 폴더 구조를 여러 번 변경했습니다. `components/ui`, `components/forms`, `components/domain` 등 다양한 구조를 시도해보면서 적절한 분리 기준을 찾아가는 과정이 쉽지 않았습니다.

또한 기존 기능을 유지하면서 안정적으로 리팩토링하는 것이 생각보다 번거로웠습니다. 테스트 코드가 없다 보니 매번 UI를 띄워서 직접 클릭해보며 동작을 확인해야 했습니다. 폼 제출, 검증 에러, 상태 변경 등을 수동으로 테스트하다 보니 시간도 오래 걸리고 놓치는 부분이 있을까 불안했습니다. 내가 짜고싶진 않지만 있으면 좋겠다는 생각이 들었습니다...

### Before 패키지에서 발견한 문제점
Before 패키지를 분석하면서 가장 먼저 눈에 띈 것은 혼재된 스타일링 방식이었습니다. 인라인 스타일, CSS 클래스, 하드코딩된 색상 값이 섞여 있어 일관성이 없었고, 디자인 토큰이 부재하여 유지보수가 어려웠습니다.

폼 상태 관리도 복잡했습니다. `useState`로 각 필드를 개별 관리하다 보니 코드 중복이 발생했고, 수동 검증 로직으로 인해 에러 처리의 일관성이 부족했습니다. 또한 불필요한 리렌더링이 자주 발생했습니다.

컴포넌트 API도 일관성이 없었습니다. 각 폼 컴포넌트마다 `helpText`, `help`, `description` 등 다른 prop 이름을 사용하고 있었고, 타입 안전성도 부족했습니다.

### 개편 과정에서 집중한 부분

**1. 로직과 UI의 완전한 분리 및 연결**

로직과 UI를 명확히 분리하고, 이를 선언적으로 연결하는 데 집중했습니다.

- **로직 레이어**: Zod 스키마로 검증 규칙 정의, React Hook Form으로 폼 상태 관리
- **UI 레이어**: 순수한 렌더링만 담당하는 컴포넌트 (`UserForm`, `ArticleForm`)
- **연결 레이어**: `FormField`의 `render` 패턴으로 로직과 UI를 선언적으로 연결
  - `control={form.control}`로 폼 엔진 연결
  - `{...field}`로 `value`, `onChange`, `ref` 자동 주입

이렇게 분리하니 각 레이어의 책임이 명확해지고, 테스트와 유지보수가 용이해졌습니다.

**2. 로직과 UI 각각의 중복 제거**

Before 패키지에서 반복되던 코드를 체계적으로 제거했습니다.

- **로직 중복 제거**:

  - Before: 각 필드마다 `useState`, `onChange` 핸들러 반복 작성
  - After: `useForm` 하나로 모든 필드 상태 통합 관리
  - 수동 검증 로직 제거 → Zod 스키마로 선언적 검증

- **UI 중복 제거**:
  - 반복되는 `FormItem` + `FormLabel` + `FormControl` + `FormMessage` 패턴을 shadcn/ui 기반으로 표준화
  - 일관된 에러 표시, 라벨 연결, 접근성 처리를 자동화
  - 컴포넌트 API 통일 (`helpText`, `help`, `description` → 일관된 구조)

**3. 도메인 특화 컴포넌트 구축**

shadcn/ui 기본 컴포넌트를 기반으로 프로젝트에 맞는 도메인 특화 컴포넌트를 구축했습니다.

- **기본 레이어**: shadcn/ui의 `Button`, `Input`, `Select` 등 범용 UI 컴포넌트
- **도메인 레이어**: `UserForm`, `ArticleForm` 등 비즈니스 요구사항을 반영한 폼 컴포넌트
- 기본 컴포넌트의 재사용성을 유지하면서도, 도메인 로직과 결합된 특화 컴포넌트 설계
- 필요시 shadcn/ui 컴포넌트를 확장하여 프로젝트 맞춤형 컴포넌트 생성 가능

### 사용한 기술 스택 경험

shadcn/ui는 라이브러리가 아닌 소스코드를 복사하는 방식이라 커스터마이징에 유리했습니다. Radix UI 기반이라 접근성이 기본 내장되어 있어 편리했고, `FormItem`, `FormLabel`, `FormControl`, `FormMessage` 구조가 일관성 있었습니다.

TailwindCSS와 CVA를 함께 사용하면서 유틸리티 클래스로 빠른 스타일링이 가능했고, CVA의 `variants` 패턴으로 조건부 스타일을 선언적으로 관리할 수 있었습니다. 디자인 토큰 기반이라 일관성 유지가 용이했습니다.

### 어려웠던 점과 해결 방법

### 리뷰받고 싶거나 질문하고 싶은 내용
- 현재 구조와 비즈니스 로직 경계

현재 구현한 컴포넌트 계층 구조는 다음과 같습니다:

```
src/
├── pages/ManagementPage.tsx (페이지 레벨)
├── hooks/ (커스텀 훅)
│   ├── useUserManagement.ts
│   └── usePostManagement.ts
├── utils/ (검증 스키마)
│   ├── userSchema.ts
│   └── articleSchema.ts
├── services/ (데이터 레이어)
│   ├── userService.ts
│   └── postService.ts
└── components/
    ├── features/ (도메인 특화)
    │   ├── UserForm.tsx
    │   ├── ArticleForm.tsx
    │   └── ManagementTable.tsx
    ├── common/ (공통 컴포넌트)
    │   ├── DataTable.tsx
    │   └── Modal.tsx
    └── ui/ (기본 UI - shadcn/ui)
        └── button, input, select...
```

이 구조에서 UI 컴포넌트가 어느 정도까지 비즈니스 로직을 가지는 것이 적절한지 궁금합니다.

- 현재 `UserForm`은 순수 렌더링만 담당하고, 로직은 `useUserManagement` 훅과 페이지에 분리했습니다.
- 하지만 실무에서는 폼 컴포넌트가 일부 로직을 가질 수도 있을 것 같습니다:
  - 필드 간 의존성 (A 필드 값에 따라 B 필드 옵션 변경)
  - 조건부 렌더링 (role이 admin일 때만 특정 필드 표시)
  - 로컬 UI 상태 (비밀번호 표시/숨김 토글)
- 어디까지를 "UI 컴포넌트의 책임"으로 보고, 어디서부터 "훅/페이지의 책임"으로 분리해야 할까요?
- 특히 조건부 렌더링 로직은 어느 레이어에 두는 것이 좋을까요?
